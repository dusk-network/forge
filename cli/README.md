# dusk-forge CLI

`dusk-forge` is the command-line interface for scaffolding and working with Dusk Forge smart contracts.

Naming note:
- Cargo package name: `dusk-forge-cli`
- Installed executable: `dusk-forge`

## Install

Install from this local repo:

```bash
cargo install --path cli
```

Install from Git (after this is pushed):

```bash
cargo install --git https://github.com/dusk-network/forge dusk-forge-cli
```

Both commands install the `dusk-forge` binary into `~/.cargo/bin`. Ensure that directory is on your `PATH`.

## Build

From the workspace root:

```bash
cargo build -p dusk-forge-cli
```

Run directly:

```bash
cargo run -p dusk-forge-cli -- --help
```

## Commands

- `dusk-forge new <name>`: scaffold a new contract project.
- `dusk-forge build [target]`: build WASM artifacts. Targets: `all` (default), `contract`, `data-driver`.
- `dusk-forge test [-- <cargo-test-args>]`: build contract WASM and run `cargo test --release`.
- `dusk-forge check`: validate project structure and toolchain.
- `dusk-forge expand [--data-driver]`: show macro expansion with `cargo-expand`.
- `dusk-forge clean`: remove `target/contract` and `target/data-driver`.
- `dusk-forge completions <shell>`: generate shell completions.

## Common Options

Project-scoped commands support:

- `--path <dir>`: contract project directory (defaults to current directory).
- `--verbose`: print executed command details.

## Examples

Create and build a project:

```bash
dusk-forge new my-counter --no-git
cd my-counter

dusk-forge check
dusk-forge build
dusk-forge build contract
dusk-forge test
```

## Toolchain Requirements

Contract builds require:

- The toolchain configured in `rust-toolchain.toml` (generated by `dusk-forge new`)
- `wasm32-unknown-unknown` target for that toolchain
- `rust-src` component for that toolchain
- No implicit fallback toolchain is used; if `rust-toolchain.toml` is missing, commands fail.

Data-driver builds require:

- The toolchain configured in `rust-toolchain.toml`
- `wasm32-unknown-unknown` target for that toolchain

Optional tools:

- `wasm-opt` for smaller WASM artifacts
- `cargo-expand` for the `expand` command

## Template Notes

`new` supports built-in templates:

- `--template counter` (default)
- `--template empty`

Contract name validation accepts lowercase kebab-case names (`[a-z0-9-]`, must start with a letter).

Scaffolded projects include:

- `rust-toolchain.toml` for deterministic toolchain selection
- `Cargo.lock` generated at scaffold time

Build/test commands run Cargo with `--locked`.
